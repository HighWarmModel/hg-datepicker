!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.DatePicker=b()}(this,function(){function a(a){return document.getElementById(a)}function b(a,b,c){var e,d=a.children;for(e=0;e<d.length;e++)d[e].style[b]=c}function c(a,b){var d,c=[];for(d=a;b>=d;d++)c.push(d);return c}function e(a){if(this.inputId=a.inputId,this.type=a.type||"date",this.title=a.title||"",this.sureText=a.sureText||"确定",this.cancelText=a.cancelText||"取消","time"===this.type){if(a.start){if(a.start.length<2)throw Error("配置项 start 不完整");this.start=[void 0,void 0,void 0,a.start[0],a.start[1]]}else this.start=[void 0,void 0,void 0,0,0];if(a.end){if(a.end.length<2)throw Error("配置项 end 不完整");this.end=[void 0,void 0,void 0,a.end[0],a.end[1]]}else this.end=[void 0,void 0,void 0,23,59];if(a.initialOption){if(a.initialOption.length<2)throw Error("配置项 initialOption 不完整");this.initialOption=[void 0,void 0,void 0,a.initialOption[0],a.initialOption[1]]}else this.initialOption=[void 0,void 0,void 0,(new Date).getHours(),(new Date).getMinutes()]}else"dateTime"===this.type?(this.start=a.start||[(new Date).getFullYear()-4,(new Date).getMonth()+1,(new Date).getDate(),(new Date).getHours(),(new Date).getMinutes()],this.end=a.end||[(new Date).getFullYear()+4,(new Date).getMonth()+1,(new Date).getDate(),(new Date).getHours(),(new Date).getMinutes()],this.initialOption=a.initialOption||[(new Date).getFullYear(),(new Date).getMonth()+1,(new Date).getDate(),(new Date).getHours(),(new Date).getMinutes()]):(this.start=a.start||[(new Date).getFullYear()-4,(new Date).getMonth()+1,(new Date).getDate()],this.end=a.end||[(new Date).getFullYear()+4,(new Date).getMonth()+1,(new Date).getDate()],this.initialOption=a.initialOption||[(new Date).getFullYear(),(new Date).getMonth()+1,(new Date).getDate()]);this.a=a.a||.001,this.style=a.style,this.hasSuffix=a.hasSuffix||"yes",this.hasZero=a.hasZero||"yes",this.success=a.success,this.cancel=a.cancel||null,this.beforeShow=a.beforeShow||null,this.check(),this.initTab(),this.initUI(),this.initEvent()}return e.prototype={constructor:e,check:function(){function a(a){return a instanceof Array?a.every(function(a){return"number"==typeof a||"undefined"==typeof a}):!1}function e(a){return(10>a?"0":"")+a}var b,c,d,f,g,h;if(!this.inputId)throw Error("配置项 inputId 不能为空.");if(!this.success)throw Error("配置项 success 不能为空.");if("yes"!==this.hasSuffix&&"no"!==this.hasSuffix)throw Error("配置项 hasSuffix 不合法.");if("yes"!==this.hasZero&&"no"!==this.hasZero)throw Error("配置项 hasZero 不合法.");if("time"!==this.type&&"dateTime"!==this.type&&"date"!==this.type)throw Error("配置项 type 不合法.");if(!a(this.start))throw Error("配置项 start 不合法");if(!a(this.end))throw Error("配置项 end 不合法");if(!a(this.initialOption))throw Error("配置项 initialOption 不合法");switch(this.type){case"date":if(this.start.length<3)throw Error("配置项 start 不完整");if(this.end.length<3)throw Error("配置项 end 不完整");if(this.initialOption.length<3)throw Error("配置项 initialOption 不完整");if(b=new Date(this.start[0],this.start[1]-1,this.start[2]).getTime(),c=new Date(this.end[0],this.end[1]-1,this.end[2]).getTime(),d=new Date(this.initialOption[0],this.initialOption[1],this.initialOption[2]).getTime(),b>c)throw Error("开始时间不能大于结束时间.");d>c&&(this.initialOption=this.end),b>d&&(this.initialOption=this.start);break;case"time":if(f=this.start[3]+e(this.start[4]),b=parseInt(f),g=this.end[3]+e(this.end[4]),c=parseInt(g),h=this.initialOption[3]+e(this.initialOption[4]),d=parseInt(h),b>c)throw Error("开始时间不能大于结束时间.");d>c&&(this.initialOption=this.end),b>d&&(this.initialOption=this.start);break;case"dateTime":if(this.start.length<5)throw Error("配置项 start 不完整");if(this.end.length<5)throw Error("配置项 end 不完整");if(this.initialOption.length<5)throw Error("配置项 initialOption 不完整");if(b=new Date(this.start[0],this.start[1]-1,this.start[2],this.start[3],this.start[4]).getTime(),c=new Date(this.end[0],this.end[1]-1,this.end[2],this.end[3],this.end[4]).getTime(),d=new Date(this.initialOption[0],this.initialOption[1]-1,this.initialOption[2],this.initialOption[3],this.initialOption[4]).getTime(),b>c)throw Error("开始时间不能大于结束时间.");d>c&&(this.initialOption=this.end),b>d&&(this.initialOption=this.start)}},initTab:function(){this.previousTime=[],this.yearArr=[],this.monthArr=[],this.dayArr=[],this.dayNumArr=[31,28,31,30,31,30,31,31,30,31,30,31],this.hourArr=[],this.minuteArr=[],this.dateArr=[],this.dateIndex=[],this.suffix="yes"===this.hasSuffix?["年","月","日","时","分"]:["","","","",""],this.input=a(this.inputId),this.wrapId=this.inputId+"-wrap",this.ulCount=0,this.liHeight=this.style&&this.style.liHeight?this.style.liHeight:40,this.btnHeight=this.style&&this.style.btnHeight?this.style.btnHeight:44,this.dateUl=[],this.liNum=[],this.curDis=[],this.curPos=[],this.startY=0,this.startTime=0,this.endTime=0,this.moveY=0,this.moveTime=0,this.moveNumber=1,this.moveSpeed=[],this.abled=!0,this.container=this.wrapId+"-container",this.box=this.wrapId+"-box",this.content=this.wrapId+"-content",this.abolish=this.wrapId+"-abolish",this.sure=this.wrapId+"-sure",this.isSelect=!0},initUI:function(){var a;for(a=0;a<this.initialOption.length;a++)this.previousTime.push(this.initialOption[a]);for(a=0;a<this.initialOption.length;a++)this.initialOption[a]&&(this.calculateArr(a),this.calculateDis(a),this.ulCount++);for(this.initDateArr(),this.initLiNum(),this.createContainer(),this.renderpicker(),a=0;a<this.dateArr.length;a++)this.dateArr[a]&&this.roll(a)},initEvent:function(){var b=this,c=b.wrap,d=a(b.container);a(b.inputId).addEventListener("click",function(){b.beforeShow&&b.beforeShow(),b.isSelect&&b.show(c,d)}),a(b.sure).addEventListener("click",function(){b.success(b.result(b.previousTime)),b.hide(c,d)}),a(b.abolish).addEventListener("click",function(){b.cancel&&b.cancel(),b.hide(c,d)}),c.addEventListener("click",function(a){a.target.id===b.wrapId&&(b.cancel&&b.cancel(),b.hide(c,d))}),b.dateUl.forEach(function(a,c){a&&(a.addEventListener("touchstart",function(){b.touch(c)},!1),a.addEventListener("touchmove",function(){b.touch(c)},!1),a.addEventListener("touchend",function(){b.touch(c)},!0))})},calculateArr:function(a){var b,d,e;switch(a){case 0:this.yearArr=c(this.start[0],this.end[0]);break;case 1:this.monthArr=[],this.monthArr=this.start[a-1]===this.end[a-1]?c(this.start[a],this.end[a]):this.curDate(a-1)===this.start[a-1]?c(this.start[a],12):this.curDate(a-1)===this.end[a-1]?c(1,this.end[a]):c(1,12);break;case 2:this.dayArr=[],this.dayNumArr[1]=this.isLeapYear(this.curDate(0))?29:28,b=new Date(this.curDate(0),this.curDate(1)-1).getTime(),d=new Date(this.start[0],this.start[1]-1).getTime(),e=new Date(this.end[0],this.end[1]-1).getTime(),this.dayArr=d===e?c(this.start[2],this.end[2]):b===d?c(this.start[2],this.dayNumArr[this.curDate(1)-1]):b===e?c(1,this.end[2]):c(1,this.dayNumArr[this.curDate(1)-1]);break;case 3:"dateTime"===this.type?(b=new Date(this.curDate(0),this.curDate(1)-1,this.curDate(2)).getTime(),d=new Date(this.start[0],this.start[1]-1,this.start[2]).getTime(),e=new Date(this.end[0],this.end[1]-1,this.end[2]).getTime(),this.hourArr=d===e?c(this.start[a],this.end[a]):b===d?c(this.start[a],23):b===e?c(0,this.end[a]):c(0,23)):this.hourArr=c(this.start[a],this.end[a]);break;case 4:"dateTime"===this.type?(b=new Date(this.curDate(0),this.curDate(1)-1,this.curDate(2),this.curDate(3)).getTime(),d=new Date(this.start[0],this.start[1]-1,this.start[2],this.start[3]).getTime(),e=new Date(this.end[0],this.end[1]-1,this.end[2],this.end[3]).getTime(),this.minuteArr=d===e?c(this.start[a],this.end[a]):b===d?c(this.start[a],59):b===e?c(0,this.end[a]):c(0,59)):this.minuteArr=this.start[a-1]===this.end[a-1]?c(this.start[a],this.end[a]):this.curDate(a-1)===this.start[a-1]?c(this.start[a],59):this.curDate(a-1)===this.end[a-1]?c(0,this.end[a]):c(0,59)}},CurArr:function(a){var b=[];return 0===a&&(b=this.yearArr),1===a&&(b=this.monthArr),2===a&&(b=this.dayArr),3===a&&(b=this.hourArr),4===a&&(b=this.minuteArr),b},curDate:function(a){var b=0;return b=0===this.dateArr.length?this.initialOption[a]:void 0===this.dateArr[a]?void 0:this.dateArr[a][this.dateIndex[a]]},calculateDis:function(a){var c,b=this.CurArr(a);if(this.previousTime[a]>b[b.length-1])this.dateIndex[a]=b.length-1;else if(this.previousTime[a]<b[0])this.dateIndex[a]=0;else for(c=0;c<b.length;c++)if(b[c]===this.previousTime[a]){this.dateIndex[a]=c;break}this.curDis[a]=-1*this.liHeight*this.dateIndex[a]},initDateArr:function(){switch(this.type){case"date":this.dateArr=[this.yearArr,this.monthArr,this.dayArr];break;case"time":this.dateArr=[void 0,void 0,void 0,this.hourArr,this.minuteArr];break;case"dateTime":this.dateArr=[this.yearArr,this.monthArr,this.dayArr,this.hourArr,this.minuteArr];break;default:throw Error("Please set a right type of hg-picker.")}},initLiNum:function(a){if(a)void 0!==this.dateArr[a]&&(this.liNum[a]=this.dateArr[a].length);else for(var b=0;b<this.dateArr.length;b++)void 0!==this.dateArr[b]&&(this.liNum[b]=this.dateArr[b].length)},createContainer:function(){var b=document.createElement("div");b.id=this.wrapId,document.body.appendChild(b),this.wrap=a(this.wrapId),this.wrap.classList.add("hg-picker-bg")},renderpicker:function(){var c,d,b=this.dateArr.length;if(this.style&&"bottom"===this.style.btnLocation){for(c='<div  class="hg-picker-container" id="'+this.container+'">'+'<div class="hg-picker-content" id="'+this.content+'">',d=0;b>d;d++)void 0!==this.dateArr[d]&&(c+=this.renderUl(d));c+='<div class="hg-picker-up-shadow"></div><div class="hg-picker-down-shadow"></div><div class="hg-picker-line"></div></div><div class="hg-picker-btn-box" id="'+this.box+'">'+this.title+'<div class="hg-picker-btn" id="'+this.abolish+'">'+this.cancelText+"</div>"+'<div class="hg-picker-btn" id="'+this.sure+'">'+this.sureText+"</div>"+"</div>"+"</div>"}else{for(c='<div  class="hg-picker-container" id="'+this.container+'">'+'<div class="hg-picker-btn-box" id="'+this.box+'">'+this.title+'<div class="hg-picker-btn" id="'+this.abolish+'">'+this.cancelText+"</div>"+'<div class="hg-picker-btn" id="'+this.sure+'">'+this.sureText+"</div>"+"</div>"+'<div class="hg-picker-content" id="'+this.content+'">',d=0;b>d;d++)void 0!==this.dateArr[d]&&(c+=this.renderUl(d));c+='<div class="hg-picker-up-shadow"></div><div class="hg-picker-down-shadow"></div><div class="hg-picker-line"></div></div></div>'}for(this.wrap.innerHTML=c,d=0;b>d;d++)void 0!==this.dateArr[d]&&(this.dateUl[d]=a(this.wrapId+"-ul-"+d),this.dateUl[d].style.width=(100/this.ulCount).toFixed(2)+"%",this.renderLi(d));this.setStyle()},setStyle:function(){var c,d,e,f,g,h,i,j;if(this.style){if(c=this.style,d=a(this.container),e=a(this.content),f=a(this.box),g=a(this.sure),h=a(this.abolish),i=e.children.length,40!==c.liHeight){for(j=0;j<this.ulCount;j++)b(e.children[j],"height",this.liHeight+"px");e.children[i-3].style.height=2*this.liHeight+"px",e.children[i-2].style.height=2*this.liHeight+"px",e.children[i-1].style.height=this.liHeight+"px",e.children[i-1].style.top=2*this.liHeight+"px",e.style.height=5*this.liHeight+"px",e.style.lineHeight=this.liHeight+"px"}44!==c.btnHeight&&(f.style.height=this.btnHeight+"px",f.style.lineHeight=this.btnHeight+"px"),c.btnOffset&&(g.style.marginRight=c.btnOffset,h.style.marginLeft=c.btnOffset),(40!==c.liHeight||44!==c.btnHeight)&&(d.style.height=5*this.liHeight+this.btnHeight+"px"),c.titleColor&&(f.style.color=c.titleColor),c.sureColor&&(g.style.color=c.sureColor),c.cancelColor&&(h.style.color=c.cancelColor),c.btnBgColor&&(f.style.backgroundColor=c.btnBgColor),c.contentColor&&(e.style.color=c.contentColor),c.contentBgColor&&(e.style.backgroundColor=c.contentBgColor),c.upShadowColor&&(e.children[i-3].style.backgroundImage=c.upShadowColor),c.downShadowColor&&(e.children[i-2].style.backgroundImage=c.downShadowColor),c.lineColor&&(e.children[i-1].style.borderColor=c.lineColor)}},renderUl:function(a){return'<ul id="'+this.wrapId+"-ul-"+a+'"></ul>'},renderLi:function(a){var d,c=this;c.dateUl[a].innerHTML="",d="<li></li><li></li>",c.dateArr[a].forEach(function(b){b=c.addZero(b),d+="<li>"+b+c.suffix[a]+"</li>"}),d+="<li></li><li></li>",c.dateUl[a].innerHTML=d,40!==this.liHeight&&b(c.dateUl[a],"height",this.liHeight+"px")},roll:function(a,b){(this.curDis[a]||0===this.curDis[a])&&(this.dateUl[a].style.transform="translate3d(0, "+this.curDis[a]+"px, 0)",this.dateUl[a].style.webkitTransform="translate3d(0, "+this.curDis[a]+"px, 0)",b&&(this.dateUl[a].style.transition="transform "+b+"s ease-out",this.dateUl[a].style.webkitTransition="-webkit-transform "+b+"s ease-out"))},touch:function(a){var c,d,e,b=b||window.event;switch(b.preventDefault(),b.type){case"touchstart":if(this.startTime=Date.now(),this.startTime-this.endTime<200)return this.abled=!1,void 0;this.abled=!0,this.startY=b.touches[0].clientY,this.curPos[a]=this.curDis[a],this.previousTime[a]=this.curDate(a),this.moveNumber=1,this.moveSpeed=[];break;case"touchmove":if(!this.abled)return;b.preventDefault(),this.moveY=b.touches[0].clientY,c=this.startY-this.moveY,this.moveTime=Date.now(),this.curDis[a]=this.curPos[a]-c,this.curDis[a]>=1.5*this.liHeight&&(this.curDis[a]=1.5*this.liHeight),this.curDis[a]<=-1*(this.liNum[a]-1+1.5)*this.liHeight&&(this.curDis[a]=-1*(this.liNum[a]-1+1.5)*this.liHeight),this.roll(a),this.moveTime-this.startTime>=130*this.moveNumber&&(this.moveNumber++,this.moveSpeed.push(c/(this.moveTime-this.startTime)));break;case"touchend":if(!this.abled)return;for(this.endTime=Date.now(),d=1===this.moveNumber?(this.startY-b.changedTouches[0].clientY)/(this.endTime-this.startTime):this.moveSpeed[this.moveSpeed.length-1],this.curDis[a]=this.curDis[a]-this.calculateBuffer(d,this.a),this.fixate(a),this.roll(a,.2),e=a;e<this.dateArr.length-1;e++)this.dateArr[e+1]&&this.changeDate(e+1);this.previousTime[a]=this.curDate(a)}},calculateBuffer:function(a,b){return Math.abs(a)<.25?0:a/Math.abs(a)*(.5*a*a/b)},fixate:function(a){this.dateIndex[a]=this.curDis[a]<=-1*(this.liNum[a]-1)*this.liHeight?this.liNum[a]-1:this.curDis[a]>=0?0:-1*Math.round(this.curDis[a]/this.liHeight),this.curDis[a]=-1*this.liHeight*this.dateIndex[a]},changeDate:function(a){this.calculateArr(a),this.dateArr[a]=this.CurArr(a),this.calculateDis(a),this.initLiNum(a),this.renderLi(a),this.roll(a)},isLeapYear:function(a){var b=0===a%4,c=0!==a%100,d=0===a%400,e=b&&c||d;return e?!0:!1},result:function(a){var c,b=[];for(c=0;c<this.dateArr.length;c++)this.dateArr[c]&&b.push(a[c]);return b},addZero:function(a){return"yes"===this.hasZero&&10>a&&(a="0"+a),a},show:function(a,b){a.classList.add("hg-picker-bg-show"),b.classList.add("hg-picker-container-up")},hide:function(a,b){a.classList.remove("hg-picker-bg-show"),b.classList.remove("hg-picker-container-up")},forbidSelect:function(a){this.isSelect=!a}},e});